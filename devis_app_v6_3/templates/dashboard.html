
{% extends 'base.html' %}
{% block title %}Tableau de bord{% endblock %}
{% block content %}
<h1 class="mb-4">Tableau de bord</h1>
<div class="row g-3 mb-4">
  <div class="col-md-2"><div class="card p-3 text-center"><div class="h6">Clients</div><div class="display-6">{{ stats.count_clients }}</div></div></div>
  <div class="col-md-2"><div class="card p-3 text-center"><div class="h6">Devis</div><div class="display-6">{{ stats.count_quotes }}</div></div></div>
  <div class="col-md-2"><div class="card p-3 text-center"><div class="h6">Brouillons</div><div class="display-6">{{ stats.count_draft }}</div></div></div>
  <div class="col-md-2"><div class="card p-3 text-center"><div class="h6">Envoyés</div><div class="display-6">{{ stats.count_sent }}</div></div></div>
  <div class="col-md-2"><div class="card p-3 text-center"><div class="h6">Acceptés</div><div class="display-6">{{ stats.count_accepted }}</div></div></div>
  <div class="col-md-2"><div class="card p-3 text-center"><div class="h6">Refusés</div><div class="display-6">{{ stats.count_refused }}</div></div></div>
</div>
<h5>Derniers devis</h5>
<table class="table table-sm">
  <thead><tr><th>Réf.</th><th>Titre</th><th>Client</th><th>Date</th><th>Statut</th><th>Total TTC</th><th></th></tr></thead>
  <tbody>
  {% for q in last_quotes %}
    <tr>
      <td>{{ q.reference or ('#' ~ q.id) }}</td>
      <td>{{ q.title }}</td>
      <td>{{ q.client.company or q.client.contact_name }}</td>
      <td>{{ q.created_at.strftime('%d/%m/%Y') }}</td>
      <td><span class="badge bg-secondary">{{ q.status }}</span></td>
      <td>{{ '%.2f'|format(q.total_ttc) }} €</td>
      <td><a class="btn btn-sm btn-outline-primary" href="{{ url_for('quote_view', quote_id=q.id) }}">Ouvrir</a></td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
